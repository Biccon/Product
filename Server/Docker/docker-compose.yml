version: '3'

services:

    ################
    ##### TEST #####
    ################
    super_test:
        build: ./superdocker
        image: super:test

        #depends_on:
        #    - front_test
        volumes:
            - ~/Product/Main_Server:/home/Main_Server
        ports:
            - "30100:3002"

        command:
            - /bin/bash
            - -c
            - |
                cd /home/Main_Server
                npm install && npm run build
                npm run copy-view && npm start

    front_test:
        build: ./frontdocker
        image: front:test2

        volumes:
            - ~/Product/Layout:/home/Layout

        ports:
            - "30300:3000"

        command:
            - /bin/bash
            - -c
            - |
                cd /home/Layout
                npm install && npm start
                

    ##################
    ##### STABLE #####
    ##################
    super:
        build: ./superdocker
        image: super:stable

        volumes:
            - ~/Product/Main_Server:/home/Main_Server
        ports:
            - "30001:3002"
        command:
            - /bin/bash
            - -c
            - |
                cd /home/Main_Server
                npm install && npm run build
                npm run copy-view && npm start
    front:
        build: ./frontdocker
        image: front:stable

        volumes:
            - ~/Product/Layout:/home/Layout
        ports:
            - "30000:3000"
        command:
            - /bin/bash
            - -c
            - |
                cd /home/Layout && npm run build
                cd LIVE && npm run start
